

  EDA 결과, 본 데이터는 유저와 책의 레이블을 받아 레이팅을 예측하는 데이터 구조임을 파악했다. 따라서 유저의 age, country 등의 variable을 카테고리화 하여 상호작용하는 필드로 사용할 수 있다고 생각하였다. 이를 위해 encoding하는 과정에서 레이블을 기반으로하는 범주형 변수로 변환하는 것이 데이터를 효과적으로 다루는 방법이라고 생각하였다. 또한 많은 column들이 존재한다고 생각하였기에 각 column을 카테고리를 가진 필드로 구성하면 각 요소의 단순 상호작용보다 더 나은 Book Rating Score 예측을 보일 것이라는 예측을 하였다. 모델링을 진행하기 위한 전처리로 user와 books의 상호작용에 초점을 맞추어 전처리를 진행하였다. 먼저 Users는 user_id,  age, location으로 이루어져 있는것을 확인하였다. 이 중에서 연령은  10살 이하 = 0 , 10~20살 = 1,…, 결측치 = 9로 categorize를 진행하였다. 다음으로 Books에서 category에 초점을 맞추었으며, 이에 대한 데이터 전처리를 주로 진행하였다. 카테고리를 범주화 하기 위해 일반적으로 사용되는 책에 대한 카테고리 50여개를 임의로 만들었다. 그리고 데이터에 해당하는 부분이 있으면 치환하는 category_high 칼럼을 추가적으로 만든 후, 결측치는 fiction으로 처리하였다. 이 후 새로 만들어진 category_high를 label_encoding을 통해 수치화한 category_high_encode를 최종적으로 만들었다. 다음으로 HyperParameter Tuning을 실시하였다. embed_dim = 32, batch_size = 1024, epochs = 30을 최종적으로 사용하였다. 그 결과, baseline의 점수인 2.5047에서 2.4685(private 2.454)로 valid_loss를 감소시켰다.

  본 모델링 연구는 추가적인 카테고리의 형성이 book rating을 더 잘 예측할 수 있는 가능성을 제시하였다. 각각의 분포된 데이터를 카테고리화 하는 것은 해당 데이터의 분포를 교정하는 것과 같은 의미를 갖는다고 할 수 있다. 이러한 교정된 분포는 데이터의 대표성을 증가시키는 의미를 가져서 불완전한 분포보다 더 결과를 예측하기 쉽다는 것을 의미한다고 할 수 있다. 하지만 본 모델링에서 age의 카테고리를 늘리는 것은 평균으로 치환한 값과 유의한 차이를 보이지 못하였다. 이는 본 연구에서 결측치를 처리한 방식보다 평균에 해당하는 36세 전후에 해당하는 약 35%가 미국인의 독자를 더 대표한다고 해석할 수 있을 것으로 사료된다(THGM book-reader survey, 2022). 다음으로 하이퍼 파라미터 튜닝의 결과 Valid Loss가 감소하는 것을 확인하였다. 본 모델링의 결과 epoch가 증가하면 과적합이 일어나는 것을 확인했으며, 임베딩 차원을 늘리면 loss가 감소하는 것을 확인하였다. 이러한 양상은 활용하고자 하는 주어진 샘플수보다 단순하기 때문에 epoch를 늘리면 모델의 적합도가 빠르게 증가한다는 것을 의미한다 할 수 있다. 추가적으로 임베딩 차원을 늘림에 따라 loss가 감소하는 것을 확인했다. 이는 단순했던 데이터를 복잡하게 만들어 학습이 의미있음을 나타낸다고 해석할 수 있다. 따라서 복잡한 계산을 할 수 있도록 적절한 하이퍼 파라미터 튜닝을 하는 것은 모델이 적절한 학습을 하는데 도움을 주는 것을 나타낸다고 해석할 수 있다. 그러나 본 모델링에서는 weight decay와 같은 과적합을 방지하는 추가적인 parameter를 다루지 못하였기에, 이러한 튜닝이 이루어졌을 경우의 결과에 대해 심도있게 확인하지 못했다는 한계점을 갖는다. 이를 종합하면 본 연구는 추가적인 카테고리를 형성하여 결측치를 제거하는 것이 모델의 성능을 높이는 것임을 확인했으며 과적합을 방지하는 하이퍼파라미터 튜닝또한 모델의 성능을 추가적으로 높일 수 있다는 것을 확인하였다. 이를 바탕으로, 추가적인 정보인 isbn의 정보에 대한 카테고리를 분류하여 모델의 복잡성을 증가시키고 하이퍼파라미터의 튜닝 부분을 추가적으로 보완한다면 더 높은 모델의 성능을 확인할 수 있을 것으로 사료된다.


abstract

  본 프로젝트는 소비자의 정보인 users, books에 대한 메타 데이터를 활용하여 소비자의 책 구매 결정의 rating 예측을 위한 평점 예측 모델을 만드는 것이다. 이에 대해 FFM, DCN, DeepCoNN, ROP-CNN, CNN_FM, Catboost, XGBoost등 모델을 사용하여 각 데이터의 유형에 따른 모델을 다양하게 사용하고자 하는 것에 초점을 두어 진행하였다. 추가적으로 이를 앙상블하여 최종적인 결과를 얻고자 하였다. 본 프로젝트의 결과 catboost : DCN : others를 7:2:1의 비율로 앙상블한 모델의 valid loss가 2.14로 최종적으로 선택되었다.